# .circleci/config.yml
version: 2.1

# Circle CI arm64 builder

jobs:
  build_arm64:
    machine:
      image: ubuntu-2204:current
    resource_class: arm.medium
    parameters:
      target-version-variant:
        type: string
    steps:
      - checkout
      - run: uname -a
      - run: docker --version
      - run: docker info
      - run: make test-<< parameters.target-version-variant >>
      - run: docker images

workflows:
  build-deploy:
    jobs:
      - build_arm64:
          matrix:
            parameters:
              target-version-variant: [
#circleci-targets-start
                "11-3.3-alpine3.18",
                "11-3.3-bookworm",
                "12-3.4-alpine3.18",
#   --skip--    "12-3.4-bookworm",  -->  generated with the related bundle job!
                "12-3.4-bundle-bookworm",
                "13-3.4-alpine3.18",
#   --skip--    "13-3.4-bookworm",  -->  generated with the related bundle job!
                "13-3.4-bundle-bookworm",
                "14-3.4-alpine3.18",
#   --skip--    "14-3.4-bookworm",  -->  generated with the related bundle job!
                "14-3.4-bundle-bookworm",
                "14-master-bookworm",
                "15-3.4-alpine3.18",
#   --skip--    "15-3.4-bookworm",  -->  generated with the related bundle job!
                "15-3.4-bundle-bookworm",
                "15-master-bookworm",
                "16-3.4-alpine3.18",
                "16-3.4-bookworm",
                "16-master-bookworm",
#circleci-targets-end
              ]
